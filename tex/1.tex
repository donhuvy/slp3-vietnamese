\setcounter{chapter}{0}

\chapter{Giới thiệu về\\ Xử lý ngôn ngữ tự nhiên}

\setlength\epigraphwidth{0.65\textwidth}
\epigraphfontsize{\small}
\epigraph{
\itshape Dave Bowman: Mở các cửa khoang ngủ ra, HAL.\\
HAL: Xin lỗi Dave, tôi e rằng tôi không thể làm thế được.\\
}{Stanley Kubrick và Arthur C. Clarke,\\
cảnh trong phim 2001: A Space Odyssey}

Ý tưởng về việc máy tính có khả năng xử lý ngôn ngữ tự nhiên đã đến từ rất lâu ngay từ khi máy tính mới xuất hiện. Quyển sách này nói về các phương pháp và sự thực hiện ý tưởng thú vị đó. Chúng tôi giới thiệu về một lĩnh vực nghiên cứu sôi động, liên ngành với rất nhiều tên gọi khác nhau, như \textbf{xử lý ngôn ngữ và tiếng nói}, \textbf{công nghệ ngôn ngữ con người}, \textbf{xử lý ngôn ngữ tự nhiên}, \textbf{ngôn ngữ học tính toán}, và \textbf{tổng hợp và nhận dạng tiếng nói}. Mục tiêu của lĩnh vực này là giúp máy tính có thể thực hiện các nhiệm vụ liên quan đến ngôn ngữ của con người, những nhiệm vụ có sự tương tác giữa máy tính-con người, cải thiện giao tiếp con người-con người, hoặc đơn giản xử lý văn bản và tiếng nói.

Một ví dụ cho lĩnh vực này là các \textbf{máy giao tiếp}. Chiếc máy tính HAL 9000 trong phim 2001: A space Odsyssey của Stanley Kubrick là một trong những nhân vật đáng chú ý trong điện ảnh thế kỷ hai mươi. HAL là một chiếc máy thông minh có khả năng xử lý ngôn ngữ tiên tiến như hiểu và nói được tiếng Anh, và thậm chí còn đọc môi. Đến bây giờ, có thể thấy tác giả Clarke đã hơi lạc quan khi dự đoán rằng một chương trình thông minh như HAL có thể thành hiện thực. Nhưng trí tưởng tượng của ông đấy đã đi xa như thế nào? Chúng ta gọi những chương trình như HAL là các \textbf{máy giao tiếp} hay các \textbf{hệ thống hội thoại}. Trong quyển sách này, chúng ta cùng tìm hiểu về các thành phần để làm nên một chương trình hội thoại hiện đại, gồm có xử lý ngôn ngữ đầu vào (\textbf{nhận dạng tiếng nói} hay \textbf{lĩnh vực hiểu ngôn ngữ}) và xử lý ngôn ngữ đầu ra (\textbf{sinh ngôn ngữ tự nhiên} hay \textbf{tổng hợp tiếng nói})

Hãy chuyển qua một nhiệm vụ hữu ích khác, đã giúp cho rất nhiều người không nói tiếng anh có thể tiếp cận được với những thông tin khoa học khổng lồ trên các trang web tiếng Anh. Hay dịch cho những người nói tiếng Anh hàng trăm triệu trang wweb viết bằng cách ngôn ngữ khác như tiếng Trung Quốc. Mục tiêu của \textbf{dịch máy} là tự động dịch một văn bản từ ngôn ngữ này sang ngôn ngữ khác. Chúng tôi sẽ giới thiệu các thuật toán  và các công cụ toán học cần thiết để hiểu một chương trình dịch máy hiện đại hoạt động như thế nào. Dịch máy là một vấn đề còn gặp nhiều thách thức, chúng tôi sẽ giới thiệu các thuật toán được sử dụng trong lĩnh vực này, cũng như các thành phần chính.

Rất nhiều nhiệm vụ xử lý ngôn ngữ liên quan đến Web. Một trong đó là \textbf{hệ thống hỏi đáp dựa trên nền Web}. Ví dụ như web tìm kiếm, khi người dùng có thể gõ một vài từ khóa để tìm kiếm thông tin, hay có thể hỏi một câu trọn vẹn, từ đơn giản đến phức tạp:

\begin{itemize}[noitemsep]
  \item "Bất đồng" có nghĩa là gì?
  \item Abraham Lincoln sinh năm nào?
  \item Ở Mỹ có bao nhiêu bang trong năm đó?
  \item Người Trung Quốc xuất khẩu bao nhiêu lụa sang Anh cho đến hết thế kỷ 18?
  \item Các nhà khoa học nghĩ gì về vấn đề đạo đức trong nhân bản người?
\end{itemize}

Một vài câu hỏi ở trên là câu hỏi \textbf{rõ ràng}, hoặc đơn giản là câu hỏi \textbf{dữ liệu thực tế} như ngày tháng hay địa điểm, có thể trả lời bằng cách sử dụng các máy tìm kiếm. Nhưng trả lời các câu hỏi phức tạp hơn có thể cần phải trích xuất thông tin trong các bản, hay phải thực hiện \textbf{suy diễn} (đưa ra kết luận từ các sự kiện), hoặc cần tóm tắt và tổng hợp thông tin từ nhiều người. Trong quyển sách này, chúng ta nghiên cứu nhiều thành phần tạo nên các hệ thống hiểu ngôn ngữ hiện đại, như \textbf{trích rút thông tin}, \textbf{phân giải nhập nhằng nghĩa từ}.

Mặc dù các lĩnh vực con và các vấn đề chúng tôi vừa nêu còn rất xa mới giải quyết được triệt để, chúng là các lĩnh vực nghiên cứu sôi động và có nhiều kỹ thuật đã có các ứng dụng công nghiệp. Trong phần còn lại của chương này, chúng tôi trình bày tóm tắt những loại kiến thức cần cho các nhiệm vụ này (và những nhiệm vụ khác như \textbf{sửa lỗi chính tả}, \textbf{kiểm tra ngữ pháp}), cũng như các mô hình toán học sẽ được giới thiệu trong sách.

\section{Tri thức trong xử lý tiếng nói và ngôn ngữ}

Sự khác biệt giữa những ứng dụng xử lý ngôn ngữ và những ứng dụng xử lý dữ liệu thông thường là việc sử dụng \textit{tri thức về ngôn ngữ}. Như chương trình Unix \verb|wc|, được sử dụng để đếm số lượng ký tự, từ và dòng trong một file văn bản. Khi dùng để đếm ký từ và dòng, \verb|wc| là một chương trình xử lý dữ liệu bình thường. Tuy nhiên, khi nó được dùng để đếm số từ, nó cần biết được \textit{tri thức về thế nào là một từ}, từ đố trở thành một chương trình xử lý ngôn ngữ.

Tất nhiên, \verb|wc| là một hệ thống rất đơn giản với sự hiểu biết rất hạn chế về tri trức của ngôn ngữ. Những hệ thống giao tiếp phức tạp như HAL, hay hệ thống thống dịch máy, hay các hệ thống hỏi đáp, yêu cầu tri thức về ngôn ngữ rộng và sâu hơn rất nhiều. Để mường tượng được phạm vi và loại tri thức cần thiết, hãy xem xét những gì mà HAL cần biết để tham gia vào cuộc hội thoại như ở ví dụ đầu trường, hoặc trong trường hợp hệ hỏi đáp, hệ thống có thể trả lời được một trong những câu hỏi kể trên.

HAL cần phải nhận ra các từ từ tín hiệu âm thanh, sau đó sinh ra âm thanh từ một chuỗi từ. Các nhiệm vụ như nhận dạng tiếng nói và tổng hợp tiếng nói yêu cầu hiểu biết về ngữ âm và âm vị học; các từ được phát âm thế nào, và các âm được nhận ra như thế nào.

Chú ý rằng không giống như Star Trek's Commander Data, HAL có khả năng nói các câu phủ định như "tôi không thể". Để có thể nói và tiếp nhận những điều này hay những đieuè khác (như nhận ra các cửa khoang ngủ là số nhiều) đòi hỏi hiểu biết về ngôn ngữ hình thái học, các một từ được tách thành các thành phần mang nghĩa như số ít với số nhiều.

Chuyển đến các từ độc lập, HAL cần sử dụng một cấu trúc thích hợp để đưa ra câu trả lời. Ví dụ, HAL cần phải hiểu chuỗi từ này là vô nghĩa đối với Dave, mặc dù nó vẫn bao gồm chính xác số từ như trong câu gốc.

\vspace{2mm}
\noindent
(1.1) Dave Xin lỗi , tôi không thể rằng e tôi thế làm được
\vspace{2mm}

Tri thức cần thiết để sắp xếp và tổ chức các từ để trở thành câu được gọi là \textbf{cú pháp}. Giờ hãy xem xét một câu hỏi trong hệ thống hỏi đáp:

\vspace{2mm}
\noindent
(1.2) Người Trung Quốc xuất khẩu bao nhiêu lụa sang Tây Âu cho đến hết thế kỷ 18?
\vspace{2mm}

Để trả lời câu hỏi này chúng ta cần biết về nghĩa từ, nghĩa của tất cả các từ (như xuất khẩu hay lụa) cũng như tổng hợp nghĩa (cụm từ Tây Âu so với Đông hoặc Nam Âu), từ \textit{hết} có nghĩa là gì khi kết hợp với \textit{thế kỷ 18}. Chúng ta cũng cần biết về liên hệ giữa từ với cấu trúc ngữ pháp. Ví dụ chúng ta cần biết cụm từ \textit{cho đến hết thế kỷ 18} là một cụm từ chỉ thời gian, chứ không phải một đơn vị, như trong ví dụ dưới đây:

\vspace{2mm}
\noindent
(1.3) Người Trung Quốc xuất khẩu bao nhiêu lụa sang Tây Âu thông qua qua các thương nhân miền nam?
\vspace{2mm}

HAL cũng cần phân biệt câu nói của Dave là một yêu cầu, thay vì là một câu mô tả hay câu hỏi về cái kiểu, như các cách nói khác nhau dưới đây

\begin{tabular}{ l l }
	 YÊU CẦU: & \textit{HAL, Mở các cửa khoang ngủ ra.} \\
	 MÔ TẢ: & \textit{HAL, các cửa khoang ngủ đang mở.} \\
	 CÂU HỎI: & \textit{HAL, các cửa khoang ngủ có mở không}
	\end{tabular}
 \label{table:1}

Mặc dù HAL không nghe lời. Nhưng HAL hiểu đủ để trả lời một cách lịch sự với Dave. Nó có thể trả lời trống không, như \textit{Không} hay \textit{Không, tôi sẽ không mở cửa}. Thay vào đó, đầu tiên nó nói xin lỗi \textit{Xin lỗi Dave}, sau đó nó thêm vào cụm từ \textit{tôi e rằng} thay vì từ chối một cách trực tiếp. Tri thức cần có cho loại câu này là tri thức về \textbf{ngữ dụng} hay \textbf{hội thoại}.

\vspace{2mm}
\noindent
(1.4) Nước Mỹ có bao nhiêu bang trong \textit{năm đó}?
\vspace{2mm}

\textit{Năm đó} là năm nào? Để có thể hiểu được những từ như \textit{năm đó}, hệ thống hỏi đáp cần xem xét các câu hỏi trước đó; trong trường hợp này, câu trước đó hỏi về năm Lincoln ra đời. Nhiệm vụ này gọi là \textbf{phân giải đồng tham chiếu}, sử dụng các từ như \textit{đó} hay các đại từ như nó hoặc cô ấy được đề cập trong những câu trước đó.

Tổng kết lại, để có sử dụng thành thạo ngôn ngữ cần có các hiểu biết về các loại tri thức:

\begin{itemize}[noitemsep]
  \item Ngữ âm và âm vị học - tri thức về âm thanh trong tiếng nói
  \item Ngôn ngữ hình thái học - tri thức về ý nghĩa của các thành phần trong từ
  \item Ngữ pháp - tri thức về cấu trúc của các từ
  \item Ngữ nghĩa - tri thức về nghĩa
  \item Ngữ dụng - tri thức về sự liên hệ giữa mục tiếu và ý định của người nói
  \item Diễn ngôn - tri thức về các đơn vị ngôn ngữ nhiều hơn một câu
\end{itemize}

\section{Nhập nhằng}

Một điều đáng chú ý về việc phân chia các tri thức về ngôn ngữ là phần lớn các nhiệm vụ trong xử lý ngôn ngữ và tiếng nói có thể xem như việc giải quyết \textbf{nhập nhằng} ở một cấp độ nhất định. Môt đầu vào được gọi là \textbf{nhập nhằng} nếu có nhiều cấu trúc ngôn ngữ có thể chỉ đến nó. Xem xét câu nói \textit{I made her duck}. Có năm cách hiểu câu trên (bạn có thể nghĩ thêm), mỗi một cách hiểu ví dụ cho sự nhâp nhằng ở từng cấp độ:

\noindent
(1.5) Tôi nấu món vịt cho cô ấy ăn.

\noindent
(1.6) Tôi nấu con vịt của cô ấy

\noindent
(1.7) Tôi tạo ra con vịt đồ chơi cho cô ấy.

\noindent
(1.8) Tôi khiến cô ấy trở nên ngốc nghếch (như con vịt).

\noindent
(1.9) Tôi biến cô ấy thành con vịt.

Các nghĩa khác nhau xảy ra bởi những sự nhập nhằng. Đầu tiên, từ \textit{duck} và \textit{her} là nhập nhằng về hình thái từ và cú pháp. Từ \textit{duck} có thể là động từ hoặc một danh từ, trong khi \textit{her} có thể là đại từ tân ngữ hoặc đại từ sở hữu. Thứ hai, từ \textit{make} cũng có sự nhập nhằng ngữ nghĩa, có thể có nghĩa là \textit{make} (tạo) hoặc \textit{cook} (nấu ăn). Cuối cùng, động từ \textit{make} cũng dẫn đến sự nhập nhằng về cú pháp. \textit{Make} có thể là ngoại động từ một tân ngữ (1.6), hoặc có thể là ngoại đông từ hai tân ngữ (1.9), trong đó tân ngữ thứ nhất (\textit{her}) bị biến thành tân ngữ thứ hai (\textit{duck}). Cuối cùng, \textit{make} có thể nhận một tân ngữ trực tiếp và một động từ (1.8), tân ngữ thứ nhất (\textit{her}) bị biến thành tân ngữ thứ hai (\textit{duck}). Hơn nữa, trong một câu nói, thậm chí còn có một mức độ nhập nhằng sâu hơn; từ thứ nhất có thể là từ \textit{eye} và từ thứ hai có thể là từ \textit{maid}.

Chúng tôi thường xuyên giới thiệu các mô hình và giải thuật trong quyển sách này là cách để \textbf{khử} hay \textbf{phân giải} nhập nhằng. Ví dụ để quyết định \textit{duck} là động từ hoặc danh từ có thể được giải quyết qua bài toán \textbf{gán nhãn từ loại}. Quyết định từ \textit{make} có nghĩa là "create" (tạo) hay "cook" (nấu ăn) có thể giải quyết qua bài toán \textbf{khử nhập nhằng nghĩa từ}. Phân giải nhập nhằng từ loại và nghĩa từ là hai bài toán quan trọng trong \textbf{khử nhập nhằng từ vựng}. Rất nhiều các bài toán khác có thể cũng được coi là bài toán khử nhập nhằng từ vựng. Như một hệ thống tổng hợp tiếng nói đọc từ \textit{lead} cần quyết định nó phát âm như trong \textit{lead pipe} hay \textit{lead me on}. Mặt khác, quyết định \textit{her} và \textit{duck} là một thành phần của một thực thể (như 1.5 hay 1.8) hay ở các thực thể riêng biệt (như 1.6) là một ví dụ của nhiệm vụ \textbf{khử nhập nhằng cú pháp} và có thể được giải quyết bằng phương pháp \textbf{probabilistic parsing} (phân tích câu dựa xác suất). Chúng ta cũng sẽ xem xét các sự nhập nhằng không xuất hiện trong ví dụ cụ thể này, như xác định một câu là câu trần thuật hay câu hỏi (có thể được giải quyết bằng việc \textbf{diễn giải hành động lời nói}).

\section{Các mô hình và giải thuật}

Một trong những điểm nhấn trong 50 năm nghiên cứu về xử lý ngôn ngữ tự nhiên là rất nhiều kiến thức được trình bày ở phần trước có thể xử lý bằng một vài mô hình và giả thuyết. May mắn thay, các mô hình và giả thuyết này được xuất hiện như những công cụ cơ bản cho khoa học máy tính, toán học, ngôn ngữ học và có thể được áp dụng giống nhau trong các ngành này. Bên cạnh những mô hình quan trọng nhất như \textbf{state machines}, \textbf{rule systems}, \textbf{logic}, \textbf{probabilistic models} và \textbf{vector-space models}. Bản thân các mô hình này, lại dựa vào một vài giải thuật cơ bản, như các giải thuật tìm kiếm trong gian trạng thái như \textbf{dynamic programming}, hay các giải thuật về học máy như các phân lớp và \textbf{Expected-Maximization (EM)} và các giải thuật khác.

Ở dạng đơn giản nhất, state machines là các mô hình hình thức bao gồm trạng thái, chuyển giữa các trạng thái, và một biểu diễn đầu vào. Một vài biến thể của mô hình cơ bản này như \textbf{deterministic} và \textbf{non-deterministic finite-state automata} và \textbf{finite-state transducers}.

Liên quan chặt chẽ đến các mô hình này là các hệ thống formal rule. Chúng ta sẽ xem xét những mô hình quan trọng nhất như \textbf{regular grammars} và \textbf{regular relations}, \textbf{context-free grammars}, và \textbf{feature-augmented grammars}. Các hệ thống máy trạng thái và formal rule là các công cụ chính để xử lý các tri thức về âm vị học, ngôn ngữ hình thái học và cú pháp.

Lớp mô hình thứ ba đóng vai trò quan trọng trong việc mô hình hóa tri thức là logic. Chúng ta sẽ tìm hiểu về \textbf{first order logic}, hay còn gọi là \textbf{predicate calculus}, cũng như các mô hình hình thức liên quan như lambda-calculus, feature-structues hay semantic primitives. Các biểu diễn logic này thường được sử dụng để mô hình hóa ngữ nghĩa và ngữ dụng, mặc dù các kỹ thuật gần đây thường tập trung vào các phương pháp hiệu quả hơn từ các ngữ liệu phi logic.

Mô hình xác suất đóng vai trò quan trọng trong việc mô hình hóa tất cả các cấp độ về ngôn ngữ. Từng mô hình khác (state machines, formal rule systems hay logic) có thể tăng cường với xác suất. Ví dụ, state machine có thể tăng cường với xác suất để trở thành \textbf{weighted automaton} hay \textbf{Markov model}. Chúng ta cũng sẽ dành một thời lượng nhất định cho \textbf{hidden Markov models} hay \textbf{HMMs}, được sử dụng ở mọi nơi, trong gán nhãn từ loại, nhận dạng tiếng nói, hiểu hội thoại, tổng hợp tiếng nói và dịch máy. Một điểm quan trọng của mô hình xác xuất là khả năng có thể giải quyết được nhiều loại nhập nhằng đã đề cập trước đó; hầu hết các bài toán về xử lý ngôn ngữ và tiếng nói có thể coi như "cho N lựa chọn từ một đầu vào nhập nhằng, chọn lựa chọn có khả năng xảy ra cao nhất".

Cuối cùng, vector-space models, dựa vào đại số tuyến tính, được sử dụng trong bài toán trích rút thông tin và nghĩa từ.

Xử lý ngôn ngữ sử dụng những mô hình này thường liên quan đến bài toán tìm kiếm trong một không gian trạng thái biểu diễn các giả định từ một đầu vào. Trong nhận dạng tiếng nói, chúng ta cần tìm kiểm trong một không gian các chuỗi âm cho một từ đầu ra. Trong bài toán phân tích cú pháp, chúng ta cần tìm kiếm trong không gian các cây biểu diễn cú pháp cho một câu đầu vào. Trong dịch máy, chúng ta cần tìm kiếm trong không gian các giả định đầu ra cho một ngôn ngữ cho một câu đầu vào ở ngôn ngữ khác. Trong các bài toán không dựa xác suất, thường liên quan đến các máy trạng thái, chúng ta sử dụng các thuật toán phổ biến về đồ thị như \textbf{depth-first search}. Đối với các bài toán dựa xác suất, chúng ta thường sử dụng nhiều giải thuật heuristic như \textbf{best-first} hay \textbf{A* search}, và dựa vào các giải thuật quy hoạch động để giảm khối lượng tính toán.

Các công cụ học máy như \textbf{các bộ phân lớp} và \textbf{các mô hình chuỗi} đóng một vị trí quan trọng trong nhiều bài toán xử lý ngôn ngữ. Dựa vào tính chất của  từng đối tượng, một bộ phân lớp thường gán mỗi đối tượng cho một lớp trong khi môt mô hình chuỗi cố gắng chuỗi các chuỗi đối tượng thành chuỗi các lớp.

Ví dụ, trong bài toán xác định một từ có đúng chính tả hay không, các bộ phân lớp như \textbf{cây quyết định}, \textbf{support vector machines}, \textbf{Gaussian Mixture Models}, và \textbf{logistic regression} có thể sử dụng để làm các bộ phân lớp nhị phân (đúng hay không đúng) cho một từ ở một thời điểm. Các mô hình chuỗi như \textbf{hidden Markov models}, \textbf{maximum entroy Markov models}, và \textbf{conditional random fields} có thể gán nhãn đúng/không đúng cho tất cả các từ trong một câu cùng một lúc.

Cuối cùng, các nhà nghiên cứu xử lý ngôn ngữ sử dụng rất nhiều công cụ từ các nhà nghiên cứu trong lĩnh vực học máy - như sử dụng tập huấn luyện và tập test, các kỹ thuật thống kê như \textbf{cross-validation}, và việc đánh giá hệ thống đã huấn luyện một cách kỹ lưỡng.






